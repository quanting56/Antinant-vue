import{c as F}from"./brush-CU99m-Ch.js";import"./transform-DNQUPihx.js";import{G as c,t as w,a as S}from"./time-58CfGA5l.js";import{e as f}from"./extent-Ccx1MofX.js";import{l as Y}from"./linear-IoaARM7T.js";import{j as $,g as j,h as E}from"./category10-aLVps2F5.js";import{o as G}from"./ordinal-BXh_4XLC.js";import{r as I,o as M,c as P,f as R}from"./index-DlM_QTRZ.js";import{s as T}from"./select-1EGbaqqT.js";import{a as H,c as J}from"./axis-qL51v-F_.js";import{l as x}from"./line-CnRH6wfh.js";import"./value-BWAEs6ZY.js";import"./pointer-BV9FWJ6s.js";import"./nodrag-CZbKbhqk.js";import"./continuous-DdKr3jbY.js";import"./round-O1hten6x.js";import"./init-Dmth1JHB.js";import"./defaultLocale-B0Uv6ZVb.js";import"./colors-Cc3OSVma.js";import"./array-DEnAxiAM.js";import"./constant-BhYcI2Bl.js";import"./path-CsjuoHvu.js";const p=600,l=400,a=50,ut={__name:"D3jsMultiLineChartWithBrushDemo",setup(N){const g=I(null);return M(async()=>{const n=T(g.value).append("svg").attr("width",p).attr("height",l),o=await $("https://data.moa.gov.tw/Service/OpenData/TransService.aspx?UnitId=5n9c3AlEJ2DH&IsTransData=1"),v=o.map(t=>c("%Y%m")(t.observeDate)),C=o.map(t=>{let r=parseFloat(t.rainfall);return r=r||0}),i=w().domain(f(v)).range([a,p-a]).nice(),h=H(i).tickFormat(t=>S("%Y/%m")(t)).ticks(6),B=n.append("g").attr("transform",`translate(0, ${l-a})`).call(h),m=Y().domain(f(C)).range([l-a,a]).nice(),D=J(m).tickFormat(t=>t+"mm");n.append("g").attr("transform",`translate(${a}, 0)`).call(D);const b=j(o,t=>t.observatory),k=G().domain(o.map(t=>t.item)).range(E),L=`multiLineChartWithBrushClip-${Math.random().toString(36).slice(2)}`;n.append("defs").append("clipPath").attr("id",L).append("rect").attr("x",a).attr("y",a).attr("width",p-a*2).attr("height",l-a*2);const y=F().extent([[a,a],[p-a,l-a]]).on("end",W),s=n.append("g");s.selectAll("path").data(b).join("path").attr("class","multiLineChartWithBrushLine").attr("d",t=>x().x(r=>i(c("%Y%m")(r.observeDate))).y(r=>{let e=parseFloat(r.rainfall);return e=e||0,m(e)})(t[1])).attr("fill","none").attr("stroke",t=>k(t)).attr("stroke-width",1.5).style("cursor","pointer"),s.attr("clip-path",`url(#${L})`).append("g").attr("class","multiLineChartWithBrushBrush").call(y);function W(t,r){const e=t.selection;e&&(i.domain([i.invert(e[0]),i.invert(e[1])]),s.select(".multiLineChartWithBrushBrush").call(y.move,null)),B.transition().duration(1e3).call(h),s.selectAll(".multiLineChartWithBrushLine").transition().duration(1e3).attr("d",A=>x().x(u=>i(c("%Y%m")(u.observeDate))).y(u=>{let d=parseFloat(u.rainfall);return d=d||0,m(d)})(A[1]))}n.on("dblclick",_);function _(){i.domain(f(v)),B.transition().duration(1e3).call(h),s.selectAll(".multiLineChartWithBrushLine").transition().duration(1e3).attr("d",t=>x().x(r=>i(c("%Y%m")(r.observeDate))).y(r=>{let e=parseFloat(r.rainfall);return e=e||0,m(e)})(t[1]))}}),(n,o)=>(R(),P("div",{ref_key:"multiLineChartWithBrushRef",ref:g},null,512))}};export{ut as default};
