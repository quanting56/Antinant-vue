import{n as J,a as K,d as L,b as D,c as E,y as Q}from"./nodrag-W5oiDWDJ.js";import{q as R}from"./transform-Dremm-ag.js";import{s as M}from"./select-D6al9h2D.js";import{p as N}from"./pointer-BV9FWJ6s.js";const x=r=>()=>r;function q(r,{sourceEvent:c,subject:b,target:p,identifier:s,active:g,x:h,y,dx:v,dy:d,dispatch:f}){Object.defineProperties(this,{type:{value:r,enumerable:!0,configurable:!0},sourceEvent:{value:c,enumerable:!0,configurable:!0},subject:{value:b,enumerable:!0,configurable:!0},target:{value:p,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:g,enumerable:!0,configurable:!0},x:{value:h,enumerable:!0,configurable:!0},y:{value:y,enumerable:!0,configurable:!0},dx:{value:v,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:f}})}q.prototype.on=function(){var r=this._.on.apply(this._,arguments);return r===this._?this:r};function U(r){return!r.ctrlKey&&!r.button}function V(){return this.parentNode}function W(r,c){return c??{x:r.x,y:r.y}}function Z(){return navigator.maxTouchPoints||"ontouchstart"in this}function re(){var r=U,c=V,b=W,p=Z,s={},g=R("start","drag","end"),h=0,y,v,d,f,T=0;function a(e){e.on("mousedown.drag",O).filter(p).on("touchstart.drag",A).on("touchmove.drag",B,J).on("touchend.drag touchcancel.drag",G).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function O(e,t){if(!(f||!r.call(this,e,t))){var u=P(this,c.call(this,e,t),e,t,"mouse");u&&(M(e.view).on("mousemove.drag",S,K).on("mouseup.drag",z,K),L(e.view),D(e),d=!1,y=e.clientX,v=e.clientY,u("start",e))}}function S(e){if(E(e),!d){var t=e.clientX-y,u=e.clientY-v;d=t*t+u*u>T}s.mouse("drag",e)}function z(e){M(e.view).on("mousemove.drag mouseup.drag",null),Q(e.view,d),E(e),s.mouse("end",e)}function A(e,t){if(r.call(this,e,t)){var u=e.changedTouches,n=c.call(this,e,t),o=u.length,l,m;for(l=0;l<o;++l)(m=P(this,n,e,t,u[l].identifier,u[l]))&&(D(e),m("start",e,u[l]))}}function B(e){var t=e.changedTouches,u=t.length,n,o;for(n=0;n<u;++n)(o=s[t[n].identifier])&&(E(e),o("drag",e,t[n]))}function G(e){var t=e.changedTouches,u=t.length,n,o;for(f&&clearTimeout(f),f=setTimeout(function(){f=null},500),n=0;n<u;++n)(o=s[t[n].identifier])&&(D(e),o("end",e,t[n]))}function P(e,t,u,n,o,l){var m=g.copy(),i=N(l||u,t),X,Y,w;if((w=b.call(e,new q("beforestart",{sourceEvent:u,target:a,identifier:o,active:h,x:i[0],y:i[1],dx:0,dy:0,dispatch:m}),n))!=null)return X=w.x-i[0]||0,Y=w.y-i[1]||0,function H(j,C,I){var F=i,k;switch(j){case"start":s[o]=H,k=h++;break;case"end":delete s[o],--h;case"drag":i=N(I||C,t),k=h;break}m.call(j,e,new q(j,{sourceEvent:C,subject:w,target:a,identifier:o,active:k,x:i[0]+X,y:i[1]+Y,dx:i[0]-F[0],dy:i[1]-F[1],dispatch:m}),n)}}return a.filter=function(e){return arguments.length?(r=typeof e=="function"?e:x(!!e),a):r},a.container=function(e){return arguments.length?(c=typeof e=="function"?e:x(e),a):c},a.subject=function(e){return arguments.length?(b=typeof e=="function"?e:x(e),a):b},a.touchable=function(e){return arguments.length?(p=typeof e=="function"?e:x(!!e),a):p},a.on=function(){var e=g.on.apply(g,arguments);return e===g?a:e},a.clickDistance=function(e){return arguments.length?(T=(e=+e)*e,a):Math.sqrt(T)},a}export{re as d};
